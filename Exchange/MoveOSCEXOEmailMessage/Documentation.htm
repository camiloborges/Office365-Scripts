<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
h1.CxSpFirst
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
h1.CxSpMiddle
	{mso-style-link:"Heading 1 Char";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
h1.CxSpLast
	{mso-style-link:"Heading 1 Char";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:13.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
pre
	{mso-style-link:"HTML Preformatted Char";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:normal;
	font-size:10.0pt;
	font-family:"Courier New";}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:normal;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{margin:0in;
	margin-bottom:.0001pt;
	line-height:normal;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Cambria","serif";
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Cambria","serif";
	font-weight:bold;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
span.HTMLPreformattedChar
	{mso-style-name:"HTML Preformatted Char";
	mso-style-link:"HTML Preformatted";
	font-family:"Courier New";}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>

<div class=WordSection1>

<h2><span style='font-size:14.0pt;line-height:115%'>Move Multiple Email
Messages to a Specific Folder in Office 365 Exchange Online</span></h2>

<p class=MsoNormal style='margin-top:10.0pt;margin-right:0in;margin-bottom:
0in;margin-left:0in;margin-bottom:.0001pt'><b><span style='font-size:13.0pt;
line-height:115%;font-family:"Cambria","serif"'>Introduction</span></b></p>

<p class=MsoNormal>This script shows how to move multiple email messages to a
specific folder in Office 365 Exchange Online. You can use this script to
search email messages that meet specified search criteria and then move these
email messages to a specific folder.</p>

<p class=MsoNormal style='margin-top:10.0pt;margin-right:0in;margin-bottom:
0in;margin-left:0in;margin-bottom:.0001pt'><b><span style='font-size:13.0pt;
line-height:115%;font-family:"Cambria","serif"'>Scenario</span></b></p>

<p class=MsoNormal>Currently, there are limitations when you move multiple
email messages by using Outlook Web App (OWA). Although, you may have already
set up Inbox rules to manage your email messages. However, you still may find that
you have to have a script to move multiple email messages in a usual manner.</p>

<h2>Prerequisite</h2>

<p class=MsoNormal>This script requires Exchange Web Service Managed API 2.0.
Please download and install the package from <a
href="http://www.microsoft.com/en-us/download/details.aspx?id=35371">Microsoft
Download Center</a>. This script cannot work correctly without this package.</p>

<h2>Script</h2>

<p class=MsoNormal>This script contains the following advanced functions: </p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Connect-OSCEXOWebService</b></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Search-OSCEXOEmailMessage</b></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Move-OSCEXOEmailMessage</b></p>

<p class=MsoNormal>You can use this script in the following way.</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Open
Windows PowerShell.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Run
<b>Import-Module</b> cmdlet to import this module file. An example is as
follows: </p>

<p class=MsoListParagraphCxSpLast><b>Import-Module <i>filepath</i>\<i>scriptname</i>.psm1</b>
 </p>

<pre>- PowerShell code snippet -</pre><pre style='background:white'><span
style='color:black'>&nbsp;</span></pre><pre style='background:white'><span
style='color:darkblue'>Try</span></pre><pre style='background:white'><span
style='color:black'>{</span></pre><pre style='background:white'><span
style='color:black'>    </span><span style='color:darkgreen'>#Get email message</span></pre><pre
style='background:white'><span style='color:black'>    </span><span
style='color:orangered'>$message</span><span style='color:black'> </span><span
style='color:darkgray'>=</span><span style='color:black'> </span><span
style='color:teal'>[Microsoft.Exchange.WebServices.Data.EmailMessage]</span><span
style='color:darkgray'>::</span><span style='color:black'>Bind(</span><span
style='color:orangered'>$exService</span><span style='color:darkgray'>,</span><span
style='color:orangered'>$MessageID</span><span style='color:black'>)</span></pre><pre
style='background:white'><span style='color:black'>&nbsp;</span></pre><pre
style='background:white'><span style='color:black'>    </span><span
style='color:orangered'>$verboseMsg</span><span style='color:black'> </span><span
style='color:darkgray'>=</span><span style='color:black'> </span><span
style='color:orangered'>$Messages</span><span style='color:darkgray'>.</span><span
style='color:black'>MoveEmailMsg</span></pre><pre style='background:white'><span
style='color:black'>    </span><span style='color:orangered'>$verboseMsg</span><span
style='color:black'> </span><span style='color:darkgray'>=</span><span
style='color:black'> </span><span style='color:orangered'>$verboseMsg</span><span
style='color:black'> </span><span style='color:darkgray'>-f</span><span
style='color:black'> </span><span style='color:orangered'>$message</span><span
style='color:darkgray'>.</span><span style='color:black'>Subject</span></pre><pre
style='background:white'><span style='color:black'>    </span><span
style='color:orangered'>$PSCmdlet</span><span style='color:darkgray'>.</span><span
style='color:black'>WriteVerbose(</span><span style='color:orangered'>$verboseMsg</span><span
style='color:black'>)</span></pre><pre style='background:white'><span
style='color:black'>&nbsp;</span></pre><pre style='background:white'><span
style='color:black'>    </span><span style='color:darkgreen'>#Move email message to the destination folder</span></pre><pre
style='background:white'><span style='color:black'>    </span><span
style='color:orangered'>$newMsg</span><span style='color:black'> </span><span
style='color:darkgray'>=</span><span style='color:black'> </span><span
style='color:orangered'>$message</span><span style='color:darkgray'>.</span><span
style='color:black'>Move(</span><span style='color:orangered'>$destFolderID</span><span
style='color:black'>)</span></pre><pre style='background:white'><span
style='color:black'>}</span></pre><pre style='background:white'><span
style='color:darkblue'>Catch</span></pre><pre style='background:white'><span
style='color:black'>{</span></pre><pre style='background:white'><span
style='color:black'>    </span><span style='color:orangered'>$PSCmdlet</span><span
style='color:darkgray'>.</span><span style='color:black'>WriteError(</span><span
style='color:orangered'>$_</span><span style='color:black'>)</span></pre><pre
style='background:white'><span style='color:black'>}</span></pre><pre>&nbsp;</pre><pre>- end -</pre>

<p class=MsoNormal>&nbsp;</p>

<h2>Examples</h2>

<p class=MsoNormal><b>Example 1</b>: How to display help about <b>Move-OSCEXOEmailMessage</b>.<br>
To display help about this function, run the following command.<br>
<b>Get-Help Move-OSCEXOEmailMessage -Full</b><br>
<img border=0 width=576 height=130 id="Picture 4"
src="Documentation_files/image001.jpg"> </p>

<p class=MsoNormal><b>Example 2</b>: How to initiate a connection to Office 365
Exchange Online.<br>
To initiate a connection to Office 365 Exchange Online, please run this
command. You must use the following example:<br>
<b>Connect-OSCEXOWebService -Credential (Get-Credential
admin@domain01.onmicrosoft.com)</b><br>
<img border=0 width=576 height=96 id="Picture 1"
src="Documentation_files/image002.jpg"><b><br>
Note </b>The <b>Connect-OSCEXOWebService</b> function creates a new variable
called <b>exService</b>. This variable is in the global scope of the current
Windows PowerShell session. This variable is used by other functions in the
script.</p>

<p class=MsoNormal><b>Example 3</b>: How to return the last 30 days email
messages in the Inbox folder.<br>
To return the last 30 days email messages in the Inbox folder, please run the
following command: <br>
<b>Search-OSCEXOEmailMessage</b><br>
<img border=0 width=576 height=63 id="Picture 5"
src="Documentation_files/image003.jpg"><b><br>
Note </b>The <b>Search-OSCEXOEmailMessage</b> function only returns email
messages in the Inbox folder, no email messages in the sub folders will be
returned.</p>

<p class=MsoNormal><b>Example 4</b>: How to return email messages that are sent
to Alan Steiner during a specific time range.<br>
To return the email messages that sent to Alan Steiner during a specific time
range, please run the following command: <br>
<b>Search-OSCEXOEmailMessage -StartDate &quot;10/1/2012&quot; -EndDate
&quot;10/30/2012&quot; -DisplayTo &quot;Alan Steiner&quot;</b><br>
<img border=0 width=576 height=152 id="Picture 6"
src="Documentation_files/image004.jpg"></p>

<p class=MsoNormal><b>Example 5</b>: How to move last 30 days email messages to
a specific folder.<br>
To move the last 30 days of email messages to a specific folder, please run the
following command: <br>
<b>Search-OSCEXOEmailMessage | Move-OSCEXOEmailMessage
-DestinationFolderDisplayName &quot;Last 30 days&quot;</b><br>
<img border=0 width=576 height=51 id="Picture 11"
src="Documentation_files/image005.jpg"></p>

<p class=MsoNormal><b>Example 6</b>: How to move email messages in a specific
time range to a folder.<br>
To move email messages in a specific time range to a folder, please run this
command. <br>
<b>Search-OSCEXOEmailMessage -StartDate &quot;2012/10/01&quot; -EndDate
&quot;2012/10/30&quot; -DisplayTo &quot;Alan Steiner&quot; |
Move-OSCEXOEmailMessage -DestinationFolderDisplayName &quot;To Me&quot;<br>
</b><img border=0 width=576 height=134 id="Picture 12"
src="Documentation_files/image006.jpg"></p>

<h2>Additional Resources</h2>

<p class=MsoNormal><b>Technical Resources: <br>
</b><a href="http://technet.microsoft.com/en-us/library/dd315326.aspx">Windows
PowerShell Advanced Function</a><span class=MsoHyperlink><br>
</span><a
href="http://msdn.microsoft.com/en-us/library/exchange/dd633671(v=exchg.80).aspx">Working
with search by using the EWS Managed API</a><br>
<a
href="http://msdn.microsoft.com/en-us/library/exchange/dd633642(v=exchg.80).aspx">Working
with items by using the EWS Managed API</a><span class=MsoHyperlink><br>
</span><br>
<b>Forum Threads: <br>
</b><a
href="http://community.office365.com/en-us/forums/160/p/73325/275394.aspx#275394">http://community.office365.com/en-us/forums/160/p/73325/275394.aspx#275394</a><u><span
style='color:blue'><br>
</span></u><a
href="http://community.office365.com/en-us/forums/158/p/44125/149292.aspx#149292">http://community.office365.com/en-us/forums/158/p/44125/149292.aspx#149292</a></p>

</div>

</body>

</html>
